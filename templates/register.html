{% extends "base.html" %}

{% block title %}Unlimited Clicker - Inscription{% endblock %}

{% block content %}
<div class="auth-container">
    <div class="auth-info">
        <div class="welcome-card">
            <h3>Bienvenue dans l'Univers Cosmique !</h3>
            <p>Rejoignez des millions d'agents cosmiques dans la plus grande aventure de clics de la galaxie !</p>
            
            <div class="game-features">
                <h4>Fonctionnalit√©s √âpiques</h4>
                <div class="features-grid">
                    <div class="feature-card">
                        <div class="feature-icon">üéØ</div>
                        <span>Clics infinis</span>
                    </div>
                    <div class="feature-card">
                        <div class="feature-icon">‚ö°</div>
                        <span>Am√©liorations cosmiques</span>
                    </div>
                    <div class="feature-card">
                        <div class="feature-icon">üåü</div>
                        <span>Syst√®me de prestige</span>
                    </div>
                    <div class="feature-card">
                        <div class="feature-icon">üèÜ</div>
                        <span>Classement galactique</span>
                    </div>
                </div>
            </div>
            
            <div class="login-link">
                <p>D√©j√† agent ? <a href="{{ url_for('main.login') }}">Acc√©der au Hub</a></p>
            </div>
        </div>
    </div>

    <div class="auth-card">
        <h2>Devenir Agent Cosmique</h2>
        
        {% if error %}
        <div class="error-message">
            <span class="error-icon">‚ö†Ô∏è</span>
            <p>{{ error }}</p>
        </div>
        {% endif %}
        
        <form method="POST" action="{{ url_for('main.register') }}" class="auth-form">
            <div class="form-group">
                <label for="username">Nom d'agent</label>
                <input type="text" id="username" name="username" class="form-input" required minlength="3" maxlength="20">
                <div class="input-decoration"></div>
                <small>3-20 caract√®res, lettres et chiffres uniquement</small>
            </div>
            
            <div class="form-group">
                <label for="password">Code d'acc√®s</label>
                <input type="password" id="password" name="password" class="form-input" required minlength="6">
                <div class="input-decoration"></div>
                <small>Minimum 6 caract√®res</small>
            </div>
            
            <div class="form-group">
                <label for="confirm-password">Confirmer le code</label>
                <input type="password" id="confirm-password" name="confirm_password" class="form-input" required minlength="6">
                <div class="input-decoration"></div>
            </div>
            
            <div class="checkbox-group">
                <label class="checkbox-label">
                    <input type="checkbox" name="terms" required>
                    <div class="checkbox-custom"></div>
                    <span>J'accepte les <a href="#" class="terms-link">conditions cosmiques</a></span>
                </label>
            </div>
            
            <button type="submit" class="btn auth-submit">
                <span>üöÄ Rejoindre l'Aventure</span>
                <div class="button-glow"></div>
            </button>
        </form>
    </div>
</div>

<style>
/* Auth container - structure principale */
.auth-container {
    display: grid;
    grid-template-columns: 1fr 1fr;
    gap: 3rem;
    max-width: 1000px;
    margin: 2rem auto;
    align-items: center;
    min-height: 60vh;
    padding: 0 1rem;
}

/* Carte d'authentification */
.auth-card {
    background: var(--glass-bg);
    border: 1px solid var(--glass-border);
    border-radius: 20px;
    padding: 3rem;
    backdrop-filter: blur(20px);
    box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
}

.auth-card h2 {
    text-align: center;
    margin-bottom: 2rem;
    font-size: 1.8rem;
    background: linear-gradient(45deg, var(--neon-blue), var(--neon-purple));
    -webkit-background-clip: text;
    background-clip: text;
    -webkit-text-fill-color: transparent;
}

/* Carte de bienvenue */
.welcome-card {
    background: var(--dark-card);
    border: 1px solid var(--dark-accent);
    border-radius: 20px;
    padding: 2.5rem;
    width: 100%;
}

.welcome-card h3 {
    font-size: 1.8rem;
    margin-bottom: 1rem;
    background: linear-gradient(45deg, var(--neon-green), var(--neon-blue));
    -webkit-background-clip: text;
    background-clip: text;
    -webkit-text-fill-color: transparent;
    text-align: center;
}

.welcome-card > p {
    text-align: center;
    color: var(--text-secondary);
    margin-bottom: 2rem;
    line-height: 1.6;
}

/* Message d'erreur */
.error-message {
    background: linear-gradient(135deg, rgba(255, 102, 102, 0.2), rgba(255, 0, 0, 0.1));
    border: 1px solid rgba(255, 0, 0, 0.3);
    border-radius: 10px;
    padding: 1rem;
    margin-bottom: 2rem;
    display: flex;
    align-items: center;
    gap: 0.5rem;
}

.error-icon {
    font-size: 1.2rem;
}

/* Formulaire */
.auth-form {
    display: flex;
    flex-direction: column;
    gap: 1.5rem;
}

.form-group {
    position: relative;
}

.form-group label {
    display: block;
    margin-bottom: 0.5rem;
    color: var(--text-secondary);
    font-weight: 500;
    text-transform: uppercase;
    letter-spacing: 1px;
    font-size: 0.9rem;
}

.form-input {
    width: 100%;
    padding: 1rem;
    background: var(--dark-card);
    border: 2px solid var(--dark-accent);
    border-radius: 10px;
    color: var(--text-primary);
    font-size: 1rem;
    transition: all 0.3s ease;
    outline: none;
}

.form-input:focus {
    border-color: var(--neon-blue);
    box-shadow: 0 0 20px rgba(0, 255, 255, 0.3);
    transform: translateY(-2px);
}

.input-decoration {
    position: absolute;
    bottom: 0;
    left: 0;
    width: 0;
    height: 2px;
    background: linear-gradient(90deg, var(--neon-blue), var(--neon-purple));
    transition: width 0.3s ease;
}

.form-input:focus + .input-decoration {
    width: 100%;
}

.form-group small {
    display: block;
    margin-top: 0.5rem;
    font-size: 0.8rem;
    color: var(--text-secondary);
    opacity: 0.8;
}

/* Checkbox personnalis√©e */
.checkbox-group {
    margin: 1.5rem 0;
}

.checkbox-label {
    display: flex;
    align-items: center;
    gap: 0.8rem;
    cursor: pointer;
}

.checkbox-label input[type="checkbox"] {
    display: none;
}

.checkbox-custom {
    width: 20px;
    height: 20px;
    border: 2px solid var(--dark-accent);
    border-radius: 4px;
    position: relative;
    transition: all 0.3s ease;
}

.checkbox-label input:checked + .checkbox-custom {
    background: var(--neon-blue);
    border-color: var(--neon-blue);
}

.checkbox-label input:checked + .checkbox-custom::after {
    content: '‚úì';
    position: absolute;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%);
    color: white;
    font-weight: bold;
}

.terms-link {
    color: var(--neon-blue);
    text-decoration: none;
}

.terms-link:hover {
    text-shadow: 0 0 10px var(--neon-blue);
}

/* Bouton de soumission */
.auth-submit {
    margin-top: 1rem;
    position: relative;
    overflow: hidden;
    background: var(--primary-gradient);
    font-size: 1.1rem;
    padding: 1.2rem;
    border: none;
    border-radius: 25px;
    color: white;
    font-weight: 600;
    cursor: pointer;
    transition: all 0.3s ease;
    text-transform: uppercase;
    letter-spacing: 1px;
}

.button-glow {
    position: absolute;
    top: 0;
    left: -100%;
    width: 100%;
    height: 100%;
    background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.2), transparent);
    transition: left 0.6s ease;
}

.auth-submit:hover .button-glow {
    left: 100%;
}

.auth-submit:hover {
    transform: translateY(-2px);
    box-shadow: 0 10px 25px rgba(0, 0, 0, 0.3);
}

/* Features de jeu */
.game-features {
    margin: 2rem 0;
}

.game-features h4 {
    font-size: 1.3rem;
    color: var(--neon-purple);
    margin-bottom: 1.5rem;
    text-align: center;
}

.features-grid {
    display: grid;
    grid-template-columns: 1fr 1fr;
    gap: 1rem;
}

.feature-card {
    background: var(--glass-bg);
    border: 1px solid var(--glass-border);
    border-radius: 10px;
    padding: 1rem;
    text-align: center;
    transition: all 0.3s ease;
}

.feature-card:hover {
    transform: translateY(-5px);
    box-shadow: 0 8px 20px rgba(0, 255, 255, 0.2);
}

.feature-icon {
    font-size: 2rem;
    margin-bottom: 0.5rem;
}

.login-link {
    text-align: center;
    margin-top: 2rem;
    padding-top: 2rem;
    border-top: 1px solid var(--dark-accent);
}

.login-link a {
    color: var(--neon-blue);
    text-decoration: none;
    transition: all 0.3s ease;
}

.login-link a:hover {
    color: var(--neon-purple);
    text-shadow: 0 0 10px var(--neon-purple);
}

/* Modal des conditions */
.terms-modal {
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background-color: rgba(0, 0, 0, 0.8);
    display: flex;
    justify-content: center;
    align-items: center;
    z-index: 2000;
    animation: modalFadeIn 0.3s ease-out;
}

@keyframes modalFadeIn {
    from { opacity: 0; }
    to { opacity: 1; }
}

.terms-modal-content {
    background: var(--dark-card);
    border: 1px solid var(--glass-border);
    border-radius: 20px;
    padding: 2rem;
    max-width: 600px;
    width: 90%;
    max-height: 80vh;
    display: flex;
    flex-direction: column;
    backdrop-filter: blur(20px);
    animation: modalSlideIn 0.3s ease-out;
}

@keyframes modalSlideIn {
    from {
        transform: translateY(-50px);
        opacity: 0;
    }
    to {
        transform: translateY(0);
        opacity: 1;
    }
}

.terms-modal h3 {
    text-align: center;
    margin-bottom: 1.5rem;
    color: var(--neon-purple);
    font-size: 1.5rem;
}

.terms-scroll {
    flex: 1;
    overflow-y: auto;
    margin-bottom: 2rem;
    padding-right: 10px;
}

.terms-scroll::-webkit-scrollbar {
    width: 6px;
}

.terms-scroll::-webkit-scrollbar-track {
    background: var(--dark-accent);
    border-radius: 3px;
}

.terms-scroll::-webkit-scrollbar-thumb {
    background: var(--neon-blue);
    border-radius: 3px;
}

.terms-scroll section {
    margin-bottom: 1.5rem;
    padding: 1rem;
    background: var(--glass-bg);
    border-radius: 10px;
    border: 1px solid var(--glass-border);
}

.terms-scroll h4 {
    color: var(--neon-blue);
    margin-bottom: 0.8rem;
    font-size: 1.1rem;
}

.terms-scroll p {
    color: var(--text-secondary);
    line-height: 1.5;
    margin: 0;
}

#close-terms {
    align-self: center;
    min-width: 150px;
    background: var(--primary-gradient);
    border: none;
    color: white;
    padding: 0.8rem 1.5rem;
    border-radius: 25px;
    font-weight: 600;
    cursor: pointer;
    transition: all 0.3s ease;
}

#close-terms:hover {
    transform: translateY(-2px);
    box-shadow: 0 10px 25px rgba(0, 0, 0, 0.3);
}

/* Responsive */
@media (max-width: 768px) {
    .auth-container {
        grid-template-columns: 1fr;
        gap: 2rem;
    }
    
    .auth-card {
        padding: 2rem;
        order: 1;
    }
    
    .auth-info {
        order: 2;
    }
    
    .features-grid {
        grid-template-columns: 1fr;
    }
}
</style>

<script>
document.addEventListener('DOMContentLoaded', () => {
    const passwordInput = document.getElementById('password');
    const confirmPasswordInput = document.getElementById('confirm-password');
    const form = document.querySelector('form');
    
    // Validation des mots de passe
    if (confirmPasswordInput) {
        form.addEventListener('submit', (event) => {
            if (passwordInput.value !== confirmPasswordInput.value) {
                event.preventDefault();
                
                // Cr√©er un message d'erreur stylis√©
                const existingError = document.querySelector('.error-message');
                if (existingError) existingError.remove();
                
                const errorDiv = document.createElement('div');
                errorDiv.className = 'error-message';
                errorDiv.innerHTML = `
                    <span class="error-icon">‚ö†Ô∏è</span>
                    <p>Les codes d'acc√®s ne correspondent pas.</p>
                `;
                
                const authCard = document.querySelector('.auth-card');
                const h2 = authCard.querySelector('h2');
                h2.insertAdjacentElement('afterend', errorDiv);
                
                confirmPasswordInput.focus();
            }
        });
    }
    
    // Gestion du lien des conditions
    const termsLink = document.querySelector('.terms-link');
    if (termsLink) {
        termsLink.addEventListener('click', (event) => {
            event.preventDefault();
            showTermsModal();
        });
    }
});

function showTermsModal() {
    const modal = document.createElement('div');
    modal.className = 'terms-modal';
    
    modal.innerHTML = `
        <div class="terms-modal-content">
            <h3>Conditions d'Utilisation Cosmiques</h3>
            <div class="terms-scroll">
                <section>
                    <h4>1. Compte Agent</h4>
                    <p>Vous √™tes responsable de la s√©curit√© de votre compte et de votre code d'acc√®s. Ne partagez pas vos identifiants avec d'autres agents.</p>
                </section>
                
                <section>
                    <h4>2. Comportement Cosmique</h4>
                    <p>Soyez respectueux envers les autres agents. Tout comportement toxique peut entra√Æner l'expulsion du Hub.</p>
                </section>
                
                <section>
                    <h4>3. Contenu Galactique</h4>
                    <p>Vous √™tes responsable de tout contenu que vous publiez, y compris votre nom d'agent.</p>
                </section>
                
                <section>
                    <h4>4. Modifications Universelles</h4>
                    <p>Nous nous r√©servons le droit de modifier le jeu et ces conditions √† tout moment pour maintenir l'√©quilibre cosmique.</p>
                </section>
                
                <section>
                    <h4>5. Limitations Dimensionnelles</h4>
                    <p>L'utilisation de bots, scripts ou tout autre moyen automatis√© est strictement interdite dans notre univers.</p>
                </section>
            </div>
            <button id="close-terms" class="btn">J'ai compris</button>
        </div>
    `;
    
    document.body.appendChild(modal);
    
    // Fermeture du modal
    document.getElementById('close-terms').addEventListener('click', () => {
        modal.remove();
    });
    
    // Fermeture en cliquant √† l'ext√©rieur
    modal.addEventListener('click', (e) => {
        if (e.target === modal) {
            modal.remove();
        }
    });
}
</script>
{% endblock %}